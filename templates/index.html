{% extends "base.html" %}
{% load timesince_years nowhitespace random_item %}
{% block description %}{% if title %}Alan Edwardes' Blog: {{ title }}{% else %}The thoughts and irrational headspew of Alan Edwardes.{% endif %}{% endblock %}

{% block title %}Alan Edwardes{% endblock %}

{% block content %}
<div class="wrp">
	{% random_item "Ciao|Hello|Salut|¡Hola|Guten tag|Aloha|Hallo|Hallå|Salam" greeting %}
	<div id="hi"><a href="/" title="Click for a new greeting">{{ greeting }}!</a> I'm a programmer<span style="color:#777">;</span></div>
	<img id="int" src="/media/languages.png" alt="Languages" width="960" height="200"/>
	<div class="tri first">
		<h2>Recent Blog Posts</h2>
		<ul>
		{% for post in posts %}
			<li>
				<a href="{{ post.get_absolute_url }}">{{ post.title|truncatewords:5 }}</a>
				{% if post.comments %}
					<a class="commentcount" href="{{ post.get_absolute_url }}#comments">{{ post.comments }}</a>
				{% endif %}
			</li>
		{% endfor %}
		</ul>
	</div>
	<div class="tri">
		<h2>Recent Tweets</h2>
		<script>{% nowhitespace %}
			$.getJSON('http://jsonpcache.alanedwardes.com/?resource=twitter_ae_timeline&callback=?', function(data) {
				c = 0;
				$(data).each(function() {
					if (!this.in_reply_to_user_id && c < 5)
					{
						dt = this.created_at.split(' ');
						li = $('<li>' + this.text + ' <a href="https://twitter.com/AlanEdwardes/status/' + this.id_str + '">' + dt[3] + ' on ' + dt[1] + ' ' + dt[2] +'</a></li>');
						$(li).hide();
						$('#tweets ul').append(li);
						$(li).delay(c * 50).fadeIn();
						c++;
					}
				});
			});
		{% endnowhitespace %}</script>
		<div id="tweets">
			<ul></ul>
		</div>
	</div>
	<div class="tri">
		<h2>About</h2>
		<p>I'm a {{ settings.BIRTH_DATE|timesince_years }} year old student from the UK. I am a programmer that dabbles in web design, and love listening to <a href="http://www.last.fm/user/alanedwardes">music</a> and playing <a href="http://steamcommunity.com/id/alanedwardes">games</a>.</p>
		<p>I enjoy satire, animated comedy, and a range of films.</p>
		<p>
			<script>document.write(ae.print_mail());</script>
		</p>
	</div>
	<script>{% nowhitespace %}
		$.getJSON('http://jsonpcache.alanedwardes.com/?resource=lastfm_ae_albums&callback=?', function(data){
			$('.game.intro #first').css('visibility','visible').hide().fadeIn();
			c = 0;
			$(data['topalbums']['album']).each(function(){
				if (this.image['1']['#text'] && !this.image['1']['#text'].match(/default/g) && c < 12)
				{
					album = $('<div id="cover-' + c + '" class="album"><a target="_blank" href="' + this.url + '" title="' + this.name + ' by ' + this.artist.name + ', played ' + this.playcount + ' times this week.' + '"><img width="64" height="64" src="' + this.image['1']['#text'] + '"/></a></div>');
					$('#lastfm').append(album);
					$(album).delay(c * 50).fadeIn();
					c++;
				}
			});
		});
	{% endnowhitespace %}</script>
	<div id="lastfm"></div>
	<script>{% nowhitespace %}
		$.getJSON('http://jsonpcache.alanedwardes.com/?resource=steam_ae_games&callback=?', function(data){
			if (data && data.mostPlayedGames && data.mostPlayedGames.mostPlayedGame)
			{
				$('.game.intro #second').css('visibility','visible').hide().fadeIn();
				$(data.mostPlayedGames.mostPlayedGame).each(function(i, game) {
					if (i < 3)
					{
						game = $('<div class="game"><a target="_blank" href="' + game.gameLink + '" title="' + game.gameName + ', played ' + game.hoursPlayed + ' hours over the past two weeks, ' + game.hoursOnRecord + ' hours total."><img width="184" height="69" src="' + game.gameLogo + '"/></a></div>');
						$('#steamgames').append(game);
						$(game).delay(i * 50).fadeIn();
					}
				});
			}
		});
	{% endnowhitespace %}</script>
	<div id="steamgames">
		<div class="game intro">
			<div id="first"><a target="_blank" href="http://www.last.fm/user/alanedwardes/charts?subtype=albums">Albums</a> I've been listening to over the past week <span>&#8593;</span></div>
			<div id="second"><a target="_blank" href="http://steamcommunity.com/id/alanedwardes/games/">Games</a> I've been playing over the past two weeks <span>&#8594;</span></div>
		</div>
	</div>
</div>
{% endblock %}